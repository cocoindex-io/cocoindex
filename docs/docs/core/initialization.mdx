---
title: Initialization
description: Initialize and set environment for CocoIndex library
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Initialize the CocoIndex Library

Before everything starts, the CocoIndex library needs to be initialized with settings.
We'll talk about the code skeleton to initialize the library in your code, and the way to provide settings for CocoIndex.

## Initialize the library

There're two options to initialize in your code:

*   Use Cocoindex CLI. It's easier to start with.
*   Explicit initialization. It's more flexible.

### CLI-Based Initialization

When you use the `cocoindex` command-line tool, the library is automatically initialized for you:

1. **Environment File Loading**:
    *   By default, the `cocoindex` CLI searches upward from the current directory for a `.env` file.
    *   You can use `--env-file <path>` to specify one explicitly:

        ```sh
        cocoindex --env-file path/to/custom.env <COMMAND> ...
        ```

    *   If no file is found, only existing system environment variables are used.
    *   Loaded variables do **not** override existing system ones.

2. **Automatic Library Initialization**:
    *   Then, the CLI automatically prepares everything using loaded environment variables â€” no manual setup required.
    *   Your script (e.g. `main.py`) is just used to discover defined flows.

    See [Environment Variables](#environment-variables) for supported variables.

    The primary way to interact with CocoIndex in this setup is via CLI commands that operate on your script:
    You interact with CocoIndex via CLI commands that operate on your script:

    ```sh
    # Example: List flows defined in my_app.py
    cocoindex ls my_app.py

    # Example: Update a specific flow in my_app.py
    cocoindex update my_app.py:MyFlowName
    ```

    See [CocoIndex CLI](/docs/core/cli) for more details.

### Explicit Initialization

Alternatively, for flexibility, you can also explicitly initialize the library by the `init()` function:

<Tabs>
<TabItem value="python" label="Python" default>

```python
import cocoindex

def main():
  ...
  cocoindex.init(
      cocoindex.Settings(
          database=cocoindex.DatabaseConnectionSpec(
              url="postgres://cocoindex:cocoindex@localhost/cocoindex"
  )))
  ...

...
if __name__ == "__main__":
  main()
```

</TabItem>
</Tabs>

## Settings

`cocoindex.Settings` is used to configure the CocoIndex library.  It's a dataclass that contains the following fields:

*   `app_namespace` (type: `str`, required): The namespace of the application.
*   `database` (type: `DatabaseConnectionSpec`, required): The connection to the Postgres database.

### App Namespace

The `app_namespace` field helps organize flows across different environments (e.g., dev, staging, production), team members, etc. When set, it prefixes flow names with the namespace.

For example, if the namespace is `Staging`, for a flow with name specified as `Flow1` in code, the full name of the flow will be `Staging.Flow1`.
You can also get the current app namespace by calling `cocoindex.get_app_namespace()` (see [Getting App Namespace](flow_def#getting-app-namespace) for more details).

If not set, all flows are in a default unnamed namespace.

You can also control it by the `COCOINDEX_APP_NAMESPACE` environment variable.

### DatabaseConnectionSpec

`DatabaseConnectionSpec` configures the connection to a database. Only Postgres is supported for now. It has the following fields:

*   `url` (type: `str`, required): The URL of the Postgres database to use as the internal storage, e.g. `postgres://cocoindex:cocoindex@localhost/cocoindex`.
*   `user` (type: `str`, optional): The username for the Postgres database. If not provided, username will come from `url`.
*   `password` (type: `str`, optional): The password for the Postgres database. If not provided, password will come from `url`.

:::tip

Please be careful that all values in `url` needs to be url-encoded if they contain special characters.
For this reason, prefer to use the separated `user` and `password` fields for username and password.

:::

:::info

If you use the Postgres database hosted by [Supabase](https://supabase.com/), please click **Connect** on your project dashboard and find the following URL:

*    If you're on a IPv6 network, use the URL under **Direct connection**. You can visit [IPv6 test](https://test-ipv6.com/) to see if you have IPv6 Internet connection.
*    Otherwise, use the URL under **Session pooler**.

:::

## Environment Variables

When using the CLI, settings are primarily loaded from environment variables. The CLI will:

*   Use the `--env-file` option if provided.
*   Otherwise, try to locate a `.env` file by searching upward from the current directory.

Each setting field has a corresponding environment variable:

| environment variable | corresponding field in `Settings` | required? |
|---------------------|-------------------|----------|
| `COCOINDEX_APP_NAMESPACE` | `app_namespace` | No |
| `COCOINDEX_DATABASE_URL` | `database.url` | Yes |
| `COCOINDEX_DATABASE_USER` | `database.user` | No |
| `COCOINDEX_DATABASE_PASSWORD` | `database.password` | No |
