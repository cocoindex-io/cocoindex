---
title: Initialization
description: Initialize the CocoIndex library
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Initialize the CocoIndex Library

Before everything starts, the `cocoindex` library needs to be initialized with settings.
There're two options to do this:

*   Using packaged main function. It's easier to start with.
*   Explicit initialization. It's more flexible.

## Using Packaged Main

The easiest way is to use a packaged main function:

<Tabs>
<TabItem value="python" label="Python" default>

The `@cocoindex.main_fn` decorator wraps your main function for CocoIndex:

```python
import cocoindex

@cocoindex.main_fn()
def main():
  ...

if __name__ == "__main__":
  main()
```

</TabItem>
</Tabs>

This takes care of the following effects:

1.  Initialize the library with settings loaded from environment variables, if not explicitly provided.
2.  If the program is executed with the `cocoindex` command, CocoIndex CLI will take over the control.
    It provides a bunch of commands for easily managing and inspecting indexes.
    See [CocoIndex CLI](/docs/core/cli) for more details.
3.  Otherwise, it will run the main function.

### Environment Variables

The following environment variables are supported:

*   `COCOINDEX_DATABASE_URL` (required): The URI of the Postgres database to use as the internal storage, e.g. `postgres://cocoindex:cocoindex@localhost/cocoindex`
*   `COCOINDEX_DATABASE_USER` (optional): The username for the Postgres database. If not provided, username will come from `COCOINDEX_DATABASE_URL`.
*   `COCOINDEX_DATABASE_PASSWORD` (optional): The password for the Postgres database. If not provided, password will come from `COCOINDEX_DATABASE_URL`.

## Explicit Initialization

Alternatively, for flexibility, you can also explicitly initialize the library by the `init()` function:

### Settings

It takes a `Settings` object as argument, which is a dataclass that contains the following fields:

*   `database` (type: `DatabaseConnectionSpec`, required): The connection to the Postgres database.

#### DatabaseConnectionSpec

`DatabaseConnectionSpec` has the following fields:
*   `uri` (type: `str`, required): The URI of the Postgres database to use as the internal storage, e.g. `postgres://cocoindex:cocoindex@localhost/cocoindex`.
*   `user` (type: `str`, optional): The username for the Postgres database. If not provided, username will come from `uri`.
*   `password` (type: `str`, optional): The password for the Postgres database. If not provided, password will come from `uri`.

### Example

<Tabs>
<TabItem value="python" label="Python" default>

```python
import cocoindex

def main():
  ...
  cocoindex.init(
      cocoindex.Settings(
          database=cocoindex.DatabaseConnectionSpec(
              uri="postgres://cocoindex:cocoindex@localhost/cocoindex"
  )))
  ...

...
if __name__ == "__main__":
  main()
```

</TabItem>
</Tabs>